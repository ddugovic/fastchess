Teaching Fasttext to play Chess
===============================

This is an experiment testing how well the simple one-layer + soft-max model of fasttext.cc
can learn to predict the best chess moves.

The project also contains a Monte Carlo Tree Search, following by Alpha Zero, which combines with the simple linear model to provide a higher quality of play.

Screenshot
==========

![Screenshot](https://raw.githubusercontent.com/thomasahle/fastchess/master/static/screenshot.png)

Run it!
=======

You'll need the following libraries:

    git clone git@github.com:facebookresearch/fastText.git
    git clone git@github.com:mcostalba/Stockfish.git
    pip install python-chess

You can train your own model as:

    python make_data.py -games 1000 | shuf > g1000
    /opt/fastText/fasttext supervised -input g1000 -output model -t 0 -neg 0 -epoch 4

And then run the program as:

    python play_chess.py model.bin

You can also generate more data by self-play (as default games are generated by stockfish)

    python make_data.py -games 1000 -selfplay model.bin > games

or train on a library of pgn files:

    python proc.py 'cclr/**/*.pgn' -test proc.test -train proc.train
    fasttext supervised -input proc.train -output model -t 0 -neg 0 -epoch 1
    fasttext test model.bin proc.test 1
